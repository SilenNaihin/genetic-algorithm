{
  "project": "Frontend Refactoring - main.ts Decomposition + Modernization",
  "goal": "Break down main.ts (4209 lines) into smaller modules (<500 lines each), migrate styles to Tailwind, prepare for React",
  "approach": "Extract one component at a time with Tailwind conversion, verify after each step, then migrate to React",
  "phases": [
    {
      "id": 1,
      "name": "Cleanup - Remove incomplete extractions",
      "status": "completed",
      "description": "Deleted untracked WIP files, removed unused dependencies"
    },
    {
      "id": 2,
      "name": "Extract AppState types",
      "status": "completed",
      "description": "Moved type definitions to src/types/app.ts"
    },
    {
      "id": 3,
      "name": "Setup Tailwind CSS",
      "status": "completed",
      "description": "Installed Tailwind v4, created src/styles/main.css with design system tokens, moved CSS from index.html"
    },
    {
      "id": 4,
      "name": "Extract CreatureMeshFactory",
      "description": "Extract createCreatureMesh and updateMuscleMesh to src/rendering/CreatureMeshFactory.ts",
      "tailwind": "No UI styles - pure Three.js rendering",
      "estimated_lines": "~120 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 5,
      "name": "Extract TooltipManager",
      "description": "Extract tooltip creation, show/hide logic to src/ui/TooltipManager.ts",
      "tailwind": "Convert .creature-tooltip styles to Tailwind utilities",
      "estimated_lines": "~50 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 6,
      "name": "Extract PreviewRenderer",
      "description": "Extract 3D preview animation (setupPreview, regeneratePreviewCreature, animatePreview) to src/rendering/PreviewRenderer.ts",
      "tailwind": "Convert .menu-preview styles to Tailwind utilities",
      "estimated_lines": "~200 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 7,
      "name": "Extract ReplayController",
      "description": "Extract replay modal and animation logic to src/ui/ReplayController.ts",
      "tailwind": "Convert modal styles to Tailwind utilities",
      "estimated_lines": "~400 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 8,
      "name": "Extract CreatureCardRenderer",
      "description": "Extract creature card creation and tooltip logic to src/ui/CreatureCardRenderer.ts",
      "tailwind": "Convert .creature-card, .creature-grid styles to Tailwind utilities",
      "estimated_lines": "~350 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 9,
      "name": "Extract GenerationNavigator",
      "description": "Extract generation navigation, load/save, fork logic to src/ui/GenerationNavigator.ts",
      "tailwind": "Convert .gen-nav styles to Tailwind utilities",
      "estimated_lines": "~450 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 10,
      "name": "Extract StatsRenderer",
      "description": "Extract getStatsHTML, updateStats, step indicators to src/ui/StatsRenderer.ts",
      "tailwind": "Convert .stats-panel, .step-indicator styles to Tailwind utilities",
      "estimated_lines": "~300 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 11,
      "name": "Extract MenuBuilder",
      "description": "Extract createMenuScreen and slider setup to src/ui/MenuBuilder.ts",
      "tailwind": "Convert .menu-screen, .param-group styles to Tailwind utilities",
      "estimated_lines": "~500 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 12,
      "name": "Extract SimulationController",
      "description": "Extract simulation/evolution logic (startSimulation, executeNextStep, autoRun) to src/simulation/SimulationController.ts",
      "tailwind": "Convert .progress-container styles to Tailwind utilities",
      "estimated_lines": "~400 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 13,
      "name": "Extract LoadRunsModal",
      "description": "Extract load runs modal creation and logic to src/ui/LoadRunsModal.ts",
      "tailwind": "Convert .modal-overlay styles to Tailwind utilities",
      "estimated_lines": "~200 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 14,
      "name": "Extract ControlPanel",
      "description": "Extract bottom control panel to src/ui/ControlPanel.ts",
      "tailwind": "Convert .control-panel, .btn styles to Tailwind utilities",
      "estimated_lines": "~150 lines",
      "verification": "npm test && npm run build"
    },
    {
      "id": 15,
      "name": "Final modular cleanup",
      "description": "Review main.ts, ensure it's under 500 lines, remove unused CSS from main.css",
      "verification": "npm test && npm run build && wc -l src/main.ts"
    },
    {
      "id": 16,
      "name": "Setup React + Next.js",
      "description": "Install React, setup Vite for React, create App.tsx shell component",
      "verification": "npm test && npm run build"
    },
    {
      "id": 17,
      "name": "Convert modules to React components",
      "description": "Convert extracted modules to React functional components, integrate state management",
      "subphases": [
        "MenuScreen component",
        "CreatureGrid component",
        "StatsPanel component",
        "ControlPanel component",
        "ReplayModal component",
        "LoadRunsModal component"
      ],
      "verification": "npm test && npm run build"
    },
    {
      "id": 18,
      "name": "State management + hooks",
      "description": "Extract app state to React context/hooks, wire up components",
      "verification": "npm test && npm run build"
    },
    {
      "id": 19,
      "name": "Final React cleanup",
      "description": "Remove old vanilla JS code, final testing",
      "verification": "Full manual test + npm test && npm run build"
    }
  ],
  "notes": [
    "Each phase should be committed separately",
    "User will manually test after each phase",
    "If any phase breaks functionality, revert and reassess",
    "Target: All files < 500 lines",
    "Tailwind: Convert CSS classes to utility classes as we extract",
    "React: Final migration after modularization is complete"
  ]
}
